data food;
   input city affluence foodexp;
datalines;
1     84.9278    0.09480
2     56.6979    0.48784
3     81.8640    0.04742
3     81.6557    0.04946
3     82.9491    0.05669
3     56.4912    0.14023
3     43.9401    0.06682
4     51.1889    0.46421
4     48.9796    0.40510
4     45.2729    0.24639
4     85.1834    0.21552
4     51.9527    0.45444
5     78.3606    0.34360
5     31.1604    0.24766
5     50.1734    0.19430
5     59.1846    0.28623
5     67.4891    0.32543
5     80.1158    0.29106
6     46.1715    0.11515
6     79.1110    0.11562
6     61.9244    0.07572
6     53.8846    0.23555
6     37.2147    0.13160
6     33.0049    0.46002
6     35.4731    0.13635
6     64.9083    0.25404
6     70.9825    0.10059
7     40.9434    0.31736
7     56.5005    0.33179
7     62.0126    0.41173
7     76.9229    0.22565
7     34.9005    0.26339
7     83.2900    0.32330
7     51.7372    0.37292
8     67.4945    0.39499
8     85.8477    0.32127
8     52.6328    0.21220
9     49.0708    0.60206
9     58.2550    0.56294
9     31.0141    0.77285
9     32.0253    0.69084
9     73.1854    0.52463
9     69.2635    0.50765
9     46.8110    0.61594
9     82.0449    0.51397
10     67.5628    0.28218
10     25.8817    0.44415
11     63.6679    0.41645
12     77.6995    0.23915
12     79.5738    0.07719
12     37.8692    0.30031
12     32.2730    0.49414
12     52.7683    0.20366
12     49.8398    0.45457
12     60.6144    0.39945
12     48.5225    0.27251
12     73.5878    0.30932
13     54.5442    0.24002
13     75.5774    0.38842
13     50.5270    0.33472
13     39.8459    0.54480
14     57.2073    0.59862
14     45.9838    0.58898
14     81.3659    0.29601
14     84.4746    0.15822
14     35.6774    0.34527
14     49.3595    0.39532
14     71.7349    0.53277
14     33.0046    0.43460
15     42.9486    0.34029
15     78.5017    0.20855
15     41.9945    0.47731
15     76.4091    0.17437
16     34.1597    0.21389
16     76.7606    0.08357
16     57.4766    0.16195
16     77.9741    0.23778
16     27.8674    0.35754
16     39.3443    0.35122
17     30.0967    0.38221
17     34.8033    0.33965
17     47.9738    0.42721
17     50.4385    0.32986
17     65.7575    0.29112
17     71.8600    0.32021
17     60.9756    0.30673
17     81.8146    0.32776
17     52.8345    0.48980
18     34.3663    0.42894
18     85.5760    0.46802
18     36.7143    0.60882
18     72.8786    0.32107
18     46.1914    0.44547
18     62.9440    0.29252
19     38.7896    0.61689
20     25.1078    0.41785
20     83.8551    0.08373
20     37.9585    0.62809
20     67.9012    0.27260
20     47.0205    0.51467
;
run;
/*** Fitting a Model for the Beta Distribution ***/
proc sgscatter data=food;
   plot foodexp*affluence / pbspline;
run;

goptions reset=all;
proc univariate data=food;
   var foodexp;
   histogram / beta(theta=0 sigma=1 alpha=est beta=est color=blue w=2)
               midpoints=0 to 1 by 0.1 kernel (color=green);
run;

/*** understand the parameterization  ***/
proc glimmix data=food;
   model foodexp = / dist=beta link=logit s ;
run;

/*** without random effects ***/
proc glimmix data=food;
   model foodexp = affluence / dist=beta link=logit s oddsratio;
run;

/*** with random effects   ***/
ods graphics on / imagemap=on tipmax=600;
proc glimmix data=food plots=studentpanel;
   class city;
   model foodexp = affluence / dist=beta link=logit s ;
   random intercept / subject=city s;
run;
ods graphics off;
